# 时间序列模拟器V2.0

时间序列模拟器V2.0版本从业务场景出发，提升V1.0模拟器的功能性和用户体验。其内网url地址为[http://192.168.21.67:8501/](http://192.168.21.67:8501/)

![image-20220920120833548](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920120833548.png)

时间序列模拟器V2.0提供了自定义模拟和导入外部文件两种方式。自定义模拟是通过自定义数据特征生成模拟数据；导入外部数据是通过对已知数据的变换生成模拟数据。

![image-20220920103144275](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920103144275.png)

## 自定义模拟

自定义模拟共包含四个模块，分别为基础属性、高级属性、特殊日/变更日、异常注入，可通过不同参数的设置组合，生成所要的模拟数据。

![image-20220920103622814](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920103622814.png)

### 基础属性

+ 起始/结束时间：设置模拟数据的起止时间；

![image-20220920104206860](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920104206860.png)

+ 颗粒度/颗粒度单位：设置时间序列的颗粒度大小，颗粒度单位有天、秒、分钟、小时、周五个选择；

![image-20220920104436119](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920104436119.png)

+ 最大/小值：设置时间序列的范围；

### 高级属性

高级属性中包含两个子模块，分别为开箱特征、自定义特征。开箱特征是定义了几种运维领域典型的时间序列数据，包含经典天周期、经典周周期、定时清理、定时跑批；自定义特征是可自行设置趋势、周期、残差三部分的参数。

![image-20220920105357697](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920105357697.png)

#### 开箱特征

开箱特征里的四个典型数据特征都是封装好的参数，可以勾选一个或多个开箱特征；

![image-20220920105933977](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920105933977.png)

![image-20220920110014796](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920110014796.png)

#### 自定义特征

+ 趋势：可以选择上升趋势还是下降趋势，并拖拉倾斜程度的滑动模块来调整倾斜幅度；

![image-20220920110459163](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920110459163.png)

+ 周期：可以通过设置周期值和周期单位生成相应的周期性数据；

![image-20220920110623885](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920110623885.png)

+ 残差：设置随机误差的波动程度和偏度，其中偏度代表了正负随机数的比例，偏度为正，正的随机数会多于负的随机数，反之亦然；

![image-20220920112201356](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920112201356.png)

## 特殊日/变更日

可添加一个或多个特殊日/变更日，特殊日是指在指定日内，数据发生一定的变化；变更日是指在指定日后的时间序列以新的趋势进行变化

![image-20220920113208817](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920113208817.png)

![image-20220920113321241](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920113321241.png)

## 异常注入

可添加一个或多个异常点；可设置异常点的程度和异常持续的时间；

![image-20220920113656457](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920113656457.png)

# 导入外部数据

导入外部数据可以通过对一份现有的数据进行模拟，跳过基础属性和高级属性的设置，直接转到特殊日/变更日和异常注入的选项，来实现模拟的效果，外部数据的文件格式仅支持CSV格式。

![image-20220920114238921](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920114238921.png)

![image-20220920114658612](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920114658612.png)

![image-20220920114759539](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920114759539.png)

# 其它功能

## 展示和下载功能

+ 展示功能：可通过勾选详细数据和设置展示前N行数据即可在线展示数据类型，还可点击列名进行升序和降序的排列；
+ 下载功能：当数据模拟好后，点击下载数据，即可将数据进行本地保存；

![image-20220920114926322](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920114926322.png)

![image-20220920115245763](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920115245763.png)

## 异常检测

该模块可直接对模拟数据进行异常值检测功能，目前仅添加了广义ESD检测，仅为测试，未来可将其它检测算法添加进来。

![image-20220920115701993](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920115701993.png)

# streamlit环境部署

该模拟器是依赖[streamlit](https://streamlit.io/)库进行搭建，可以部署在服务器上，通过url进行使用。

![image-20220920142837456](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920142837456.png)

## 运行环境

+ python>=3.0
+ requirements:
  - streamlit>=1.12.2
  - others：根据程序所需要的库进行配置，以下是时间序列模拟器所用到的库
    + pandas==1.4.3
    + numpy==1.23.2
    + scipy==1.9.1
    + matplotlib==3.6.0
    + openpyxl==3.0.10
    + datetime
    + time
    + PIL
    + typing

## 部署物料

仅需xxx.py脚本文件，其余物料根据程序所需自行添加，且所有物料都得与py文件放置同一路径下，或者是py文件所在的子目录中，以时间序列模拟器V2.0为例

![image-20220920144419374](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920144419374.png)

## 部署方式

终端运行，在终端中cd到xxx.py的目录下，再输入nohup streamlit run xxx.py即可部署完成，以时间序列模拟器V2.0为例

![image-20220920144805545](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920144805545.png)

![image-20220920144833019](C:\Users\Mloong\AppData\Roaming\Typora\typora-user-images\image-20220920144833019.png)